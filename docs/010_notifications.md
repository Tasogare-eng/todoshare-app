# 010: 通知機能

## 概要
アプリ内通知システムの実装（Todo依頼、期限リマインダー等）

## 目的
- 重要な情報の伝達
- ユーザーエンゲージメントの向上
- タスクの実行率向上

## タスク

### データベース設計
- [ ] Notificationsテーブルの作成
- [ ] 通知タイプの定義と管理
- [ ] RLSポリシーの設定
- [ ] インデックスの設定

### バックエンド実装
- [ ] Notificationモデルの作成
- [ ] 通知生成サービスクラス
- [ ] 通知一覧取得API（GET /api/notifications）
- [ ] 未読通知数取得API（GET /api/notifications/unread-count）
- [ ] 通知既読API（PATCH /api/notifications/{id}/read）
- [ ] 一括既読API（PATCH /api/notifications/mark-all-read）
- [ ] 通知削除API（DELETE /api/notifications/{id}）
- [ ] 通知設定管理API
- [ ] リアルタイム通知（WebSocket/SSE）

### フロントエンド実装
- [ ] 通知ストア（Pinia）の作成
- [ ] 通知ベルアイコンコンポーネント
- [ ] 通知ドロップダウンコンポーネント
- [ ] 通知カードコンポーネント
- [ ] 通知一覧ページ
- [ ] 通知設定ページ
- [ ] プッシュ通知機能（オプション）
- [ ] リアルタイム通知受信

### 通知タイプ
- [ ] Todo依頼受信
- [ ] 依頼承認/拒否
- [ ] 依頼したTodoの完了通知
- [ ] 期限リマインダー（1日前、当日）
- [ ] 期限切れ警告
- [ ] システムメンテナンス通知
- [ ] 新機能アナウンス

### 通知設定
- [ ] 通知タイプ別ON/OFF
- [ ] 期限リマインダーのタイミング設定
- [ ] 通知時間の制限（夜間はOFF等）
- [ ] 緩急度別設定（緊急/普通/情報）
- [ ] ユーザー別ブロック機能

### リアルタイム機能
- [ ] WebSocket接続の管理
- [ ] リアルタイム通知の受信
- [ ] 接続状態の管理
- [ ] オフライン時の通知蓄積

### UI/UX
- [ ] 未読バッジの表示
- [ ] 通知アイコンのデザイン
- [ ] 通知音の設定
- [ ] 通知のグループ化
- [ ] スナックバー通知
- [ ] 通知フィルター機能

### パフォーマンス
- [ ] 通知のページネーション
- [ ] 古い通知の自動削除
- [ ] キャッシュの活用
- [ ] バッチ処理の最適化

### テスト
- [ ] 通知生成テスト
- [ ] 通知CRUD APIテスト
- [ ] リアルタイム通知テスト
- [ ] 通知設定テスト
- [ ] パフォーマンステスト

## 完了条件
- [ ] アプリ内で通知を受信できる
- [ ] 通知の既読/未読管理ができる
- [ ] 通知設定がカスタマイズできる
- [ ] リアルタイムで通知を受信できる
- [ ] 期限リマインダーが正しく動作する

## 技術詳細
- リアルタイム: Supabase Realtime
- WebSocket: ブラウザーサポート
- プッシュ通知: Service Worker API

## 推定工数
2日

## 依存関係
- 002_authentication.mdが完了していること

## 備考
- メール通知はMVP後に検討
- プッシュ通知はMVP後に検討
- 通知の保存期間は30日間