# 002: 認証機能

## 概要
ユーザー認証とアカウント管理機能の実装

## 目的
- セキュアなユーザー認証システムの構築
- Google OAuth連携の実装
- セッション管理の実装

## タスク

### バックエンド実装
- [x] Userモデルの作成（SQLAlchemy）
- [x] Pydanticスキーマの作成（UserCreate, UserLogin, UserResponse）
- [x] パスワードハッシュ化処理（bcrypt）
- [x] JWTトークン生成・検証処理
- [x] 認証ミドルウェアの作成
- [x] ユーザー登録API（/api/auth/register）
- [x] ログインAPI（/api/auth/login）
- [x] ログアウトAPI（/api/auth/logout）
- [x] 現在のユーザー情報取得API（/api/auth/me）
- [ ] パスワードリセットAPI（/api/auth/reset-password）

### Google OAuth実装
- [ ] Google Cloud ConsoleでOAuthクライアント作成
- [ ] Supabase AuthでGoogle OAuth設定
- [ ] OAuthコールバックAPIの実装
- [ ] OAuthユーザー情報とローカルユーザーの紐付け

### フロントエンド実装
- [x] ログインページコンポーネント
- [x] 新規登録ページコンポーネント
- [ ] パスワードリセットページコンポーネント
- [ ] Googleログインボタンの実装
- [x] 認証ストア（Pinia）の作成
- [x] JWTトークンの保存・管理
- [x] APIインターセプターの設定（認証ヘッダー付与）
- [x] ルートガードの実装

### バリデーション
- [x] メールアドレス形式のバリデーション
- [x] パスワード強度のチェック（最低8文字、英数記号含む）
- [x] ユーザー名の重複チェック
- [x] メールアドレスの重複チェック

### セキュリティ
- [ ] HTTPS通信の確認
- [ ] CSRFトークンの実装
- [ ] レートリミットの実装（ログイン試行回数制限）
- [ ] JWTトークンの有効期限設定

### テスト
- [ ] ユーザー登録テスト
- [ ] ログイン・ログアウトテスト
- [ ] Google OAuthテスト
- [ ] パスワードリセットテスト
- [ ] 認証ミドルウェアテスト

## 完了条件
- [x] メール/パスワードでユーザー登録・ログインができる
- [ ] Googleアカウントでログインができる
- [x] ログイン後、認証が必要なページにアクセスできる
- [x] ログアウト後、認証が必要なページにアクセスできない
- [ ] パスワードリセットが動作する

## 技術詳細
- 認証: JWT (RS256)
- パスワードハッシュ: bcrypt
- OAuth: Google OAuth 2.0
- セッション管理: Supabase Auth

## 推定工数
3日

## 依存関係
- 001_project_setup.mdが完了していること

## 備考
- JWTトークンはセキュアなHTTP-Only Cookieに保存することを検討
- パスワードリセットはメール送信機能がMVP後になるため、一時的な実装とする